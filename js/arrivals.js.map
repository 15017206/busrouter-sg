{"version":3,"file":"arrivals.js","sources":["../assets/js/lscache.js","../assets/js/arrival.js"],"names":["root","factory","define","amd","module","exports","lscache","this","supportsStorage","key","value","undefined","cachedStorage","setItem","removeItem","e","isOutOfSpace","name","supportsJSON","cachedJSON","window","JSON","escapeRegExpSpecialCharacters","text","replace","expirationKey","CACHE_SUFFIX","currentTime","Math","floor","Date","getTime","EXPIRY_UNITS","getItem","localStorage","CACHE_PREFIX","cacheBucket","eachKey","fn","prefixRegExp","RegExp","i","length","match","indexOf","flushItem","exprKey","flushExpiredItem","expr","expirationTime","parseInt","EXPIRY_RADIX","warn","message","err","warnings","console","MAX_DATE","set","time","stringify","storedKey","storedKeys","expiration","push","size","sort","a","b","targetSize","pop","toString","get","parse","remove","supported","flush","flushExpired","setBucket","bucket","resetBucket","enableWarnings","enabled","$arrivals","document","getElementById","arrivalsTimeout","xhr","XMLHttpRequest","showArrivals","id","hidden","visibilityState","setTimeout","open","onload","classList","result","responseText","error","innerHTML","services","next","duration_ms","map","service","no","timeDisplay","subsequent","join","onerror","send","add","ms","mins","ceil","rootEndPoints","github","s3","dataEndPoints","busStops","busServices","busService","busStopsServices","getData","params","done","arguments","data","useS3","GZIP_ENABLED","endPoint","split","p","onabort","stops","stopsMap","reduce","obj","onhashchange","hash","location","slice","stop","clearTimeout","coords","lat","lng","title","style","backgroundImage","alert"],"mappings":"CAoBC,SAAUA,EAAMC,GACS,kBAAXC,SAAyBA,OAAOC,IAEvCD,UAAWD,GACc,mBAAXG,SAA0BA,OAAOC,QAE/CD,OAAOC,QAAUJ,IAGjBD,EAAKM,QAAUL,KAErBM,KAAM,WA2BN,QAASC,KACP,GAAIC,GAAM,kBACNC,EAAQD,CAEZ,IAAsBE,SAAlBC,EACF,MAAOA,EAGT,KACEC,EAAQJ,EAAKC,GACbI,EAAWL,GACXG,GAAgB,EAChB,MAAOG,GAEDH,EADAI,EAAaD,IACG,GAEA,EAGxB,MAAOH,GAIT,QAASI,GAAaD,GACpB,MAAIA,IAAgB,uBAAXA,EAAEE,MACQ,+BAAXF,EAAEE,MACS,uBAAXF,EAAEE,MACC,GAEJ,EAIT,QAASC,KAKP,MAHmBP,UAAfQ,IACFA,EAA6B,MAAfC,OAAOC,MAEhBF,EAQT,QAASG,GAA8BC,GACrC,MAAOA,GAAKC,QAAQ,2BAA4B;;CAQlD,QAASC,GAAchB,GACrB,MAAOA,GAAMiB,EAOf,QAASC,KACP,MAAOC,MAAKC,OAAO,GAAIC,OAAOC,UAAWC,GAO3C,QAASC,GAAQxB,GACf,MAAOyB,cAAaD,QAAQE,EAAeC,EAAc3B,GAG3D,QAASI,GAAQJ,EAAKC,GAEpBwB,aAAapB,WAAWqB,EAAeC,EAAc3B,GACrDyB,aAAarB,QAAQsB,EAAeC,EAAc3B,EAAKC,GAGzD,QAASI,GAAWL,GAClByB,aAAapB,WAAWqB,EAAeC,EAAc3B,GAGvD,QAAS4B,GAAQC,GAGf,IAAK,GAFDC,GAAe,GAAIC,QAAO,IAAML,EAAeb,EAA8Bc,GAAe,QAEvFK,EAAIP,aAAaQ,OAAO,EAAGD,GAAK,IAAMA,EAAG,CAChD,GAAIhC,GAAMyB,aAAazB,IAAIgC,EAC3BhC,GAAMA,GAAOA,EAAIkC,MAAMJ,GACvB9B,EAAMA,GAAOA,EAAI,GACbA,GAAOA,EAAImC,QAAQlB,GAAgB,GACrCY,EAAG7B,EAAKgB,EAAchB,KAK5B,QAASoC,GAAUpC,GACjB,GAAIqC,GAAUrB,EAAchB,EAE5BK,GAAWL,GACXK,EAAWgC,GAGb,QAASC,GAAiBtC,GACxB,GAAIqC,GAAUrB,EAAchB,GACxBuC,EAAOf,EAAQa,EAEnB,IAAIE,EAAM,CACR,GAAIC,GAAiBC,SAASF,EAAMG;;AAGpC,GAAIxB,KAAiBsB,EAGnB,MAFAnC,GAAWL,GACXK,EAAWgC,IACJ,GAKb,QAASM,GAAKC,EAASC,GAChBC,GACC,WAAanC,SAA0C,kBAAxBA,QAAOoC,QAAQJ,OACpDhC,OAAOoC,QAAQJ,KAAK,aAAeC,GAC/BC,GAAKlC,OAAOoC,QAAQJ,KAAK,4BAA8BE,EAAID,UArJjE,GAcIzC,GACAO,EAfAgB,EAAe,WAGfT,EAAe,mBAGfyB,EAAe,GAGfnB,EAAe,IAGfyB,EAAW7B,KAAKC,MAAM,OAAQG,GAI9BI,EAAc,GACdmB,GAAW,EAuIXjD,GAOFoD,IAAK,SAASjD,EAAKC,EAAOiD,GACxB,GAAKnD,IAAL,CAKA,GAAqB,gBAAVE,GAAoB,CAC7B,IAAKQ,IAAgB,MACrB,KACER,EAAQW,KAAKuC,UAAUlD,GACvB,MAAOK,GAGP,QAIJ,IACEF,EAAQJ,EAAKC,GACb,MAAOK,GACP,IAAIC,EAAaD,GAuCf,WADAqC,GAAK,gCAAkC3C,EAAM,IAAKM,EAnClD,IACI8C,GADAC,IAEJzB;EAAQ,SAAS5B,EAAKqC,GACpB,GAAIiB,GAAa9B,EAAQa,EAEvBiB,GADEA,EACWb,SAASa,EAAYZ,GAGrBM,EAEfK,EAAWE,MACTvD,IAAKA,EACLwD,MAAOhC,EAAQxB,IAAQ,IAAIiC,OAC3BqB,WAAYA,MAIhBD,EAAWI,KAAK,SAASC,EAAGC,GAAK,MAAQA,GAAEL,WAAWI,EAAEJ,YAGxD,KADA,GAAIM,IAAc3D,GAAO,IAAIgC,OACtBoB,EAAWpB,QAAU2B,EAAa,GACvCR,EAAYC,EAAWQ,MACvBlB,EAAK,0CAA4C3C,EAAM,KACvDoC,EAAUgB,EAAUpD,KACpB4D,GAAcR,EAAUI,IAE1B,KACEpD,EAAQJ,EAAKC,GACb,MAAOK,GAGP,WADAqC,GAAK,gCAAkC3C,EAAM,2BAA4BM,IAW3E4C,EACF9C,EAAQY,EAAchB,IAAOkB,IAAgBgC,GAAMY,SAASpB,IAG5DrC,EAAWW,EAAchB,MAS7B+D,IAAK,SAAS/D,GACZ,IAAKD,IAAmB,MAAO,KAG/B,IAAIuC,EAAiBtC,GAAQ,MAAO,KAGpC,IAAIC,GAAQuB,EAAQxB,EACpB,KAAKC,IAAUQ,IACb,MAAOR;;AAGT,IAEE,MAAOW,MAAKoD,MAAM/D,GAClB,MAAOK,GAEP,MAAOL,KASXgE,OAAQ,SAASjE,GACVD,KAELqC,EAAUpC,IAQZkE,UAAW,WACT,MAAOnE,MAMToE,MAAO,WACApE,KAEL6B,EAAQ,SAAS5B,GACfoC,EAAUpC,MAOdoE,aAAc,WACPrE,KAEL6B,EAAQ,SAAS5B,GACfsC,EAAiBtC,MAQrBqE,UAAW,SAASC,GAClB3C,EAAc2C,GAMhBC,YAAa,WACX5C,EAAc,IAMhB6C,eAAgB,SAASC,GACvB3B,EAAW2B,GAKf,OAAO5E,ICrWT,IAAI6E,WAAYC,SAASC,eAAe,YACpCC,gBACAC,IAAM,GAAIC,gBACVC,aAAe,SAASC,GAC3B,MAAIN,UAASO,QAAsC,UAA5BP,SAASQ,qBAE/BN,gBAAkBO,WAAW;AAC5BJ,aAAaC,IACX,QAGJH,IAAIO,KAAK,MAAO,uCAAyCJ,GAAI,GAC7DH,IAAIQ,OAAS,WACZZ,UAAUa,UAAUtB,OAAO,SAC3B,IAAIuB,GAAS5E,KAAKoD,MAAMlE,KAAK2F,aACxBD,KAAUA,EAAOE,QACtBhB,UAAUiB,UAAYH,EAAOI,SAASnC,KAAK,SAASC,EAAGC,GACtD,MAA0B,OAAtBD,EAAEmC,KAAKC,YAA4B,EACb,MAAtBnC,EAAEkC,KAAKC,YAA4B,GAChCpC,EAAEmC,KAAKC,YAAcnC,EAAEkC,KAAKC,cACjCC,IAAI,SAASC,GACf,MAAO,WACMA,EAAQC,GAAK,YACbC,YAAYF,EAAQH,KAAKC,aAAe,YACxCI,YAAYF,EAAQG,WAAWL,aAAe,eAEzDM,KAAK;AACRvB,gBAAkBO,WAAW,WAC5BJ,aAAaC,IACX,QAEJH,IAAIuB,QAAU,WACbxB,gBAAkBO,WAAW,WAC5BJ,aAAaC,IACX,MAEJH,IAAIwB,WACJ5B,WAAUa,UAAUgB,IAAI,YAGrBL,YAAc,SAASM,GAC1B,GAAU,MAANA,EAAY,MAAO,gDACvB,IAAIC,GAAOtF,KAAKuF,KAAKF,EAAG,IAAK,GAC7B,OAAY,IAARC,EAAkB,MACV,GAARA,EAAkBA,EAAO,OACtBA,EAAO,SAGXE,eACHC,OAAQ,aACRC,GAAI,4DAEDC,eACHC,SAAU,iBACVC,YAAa;AACbC,WAAY,2BACZC,iBAAkB,2BAGfC,QAAU,SAASnH,EAAKoH,EAAQC,GACX,GAApBC,UAAUrF,SACboF,EAAOD,EACPA,KAED,IAAIG,GAAO1H,QAAQkE,IAAI/D,EACvB,IAAIuH,EACHF,EAAK,KAAME,OACL,CACN,GAAIzC,GAAM,GAAIC,gBACVyC,EAAQ,mBAAqB1C,IAA8B,mBAAhB2C,eAA+BA,aAC1EC,EAAWf,cAAca,EAAQ,KAAO,UAAYV,cAAc9G,EAAI2H,MAAM,KAAK,GACrF,KAAKC,IAAKR,GAAQM,EAAWA,EAAS3G,QAAQ,KAAO6G,EAAI,KAAMR,EAAOQ,GAClEJ,KAAOE,GAAY,MAAQ,GAAIrG,OACnCyD,EAAIQ,OAAS,WACZ,IACC,GAAIiC,GAAO3G,KAAKoD,MAAMlE,KAAK2F,aAC3B4B,GAAK,KAAME,GACX1H,QAAQoD,IAAIjD,EAAKuH,EAAM,MACtB,MAAOjH;AACR+G,EAAK/G,KAGPwE,EAAIuB,QAAUvB,EAAI+C,QAAUR,EAC5BvC,EAAIO,KAAK,MAAOqC,GAAU,GAC1B5C,EAAIwB,QAINa,SAAQ,WAAY,SAASzB,EAAOoC,GACnC,GAAIC,GAAWD,EAAME,OAAO,SAASjC,EAAKkC,GAEzC,MADAlC,GAAIkC,EAAIhC,IAAMgC,EACPlC,MAGRpF,QAAOuH,aAAe,WACrB,GAAIC,GAAOC,SAASD,KAAKE,MAAM,GAC3BC,EAAOP,EAASI,EAGpB,IAFAI,aAAa1D,iBAETsD,GAAQG,EAAK,CAChB,GAAIE,GAASF,EAAKG,IAAM,IAAMH,EAAKI,IAC/BlI,EAAO2H,EAAO,MAAQG,EAAK9H,IAC/BmE,UAASgE,MAAQ,yBAA2BnI,EAC5CmE,SAASC,eAAe,iBAAiBe,UAAYnF,EACrDmE,SAASC,eAAe,oBAAoBgE,MAAMC,gBAAkB,uDAGjE,8CACA,UAAYL,EACZ,UACA,UACA,eACA,kBACA,cACCpC,KAAK,KACN;AACHpB,aAAamD,OAEbW,OAAM,2BAGRnI,OAAOuH"}